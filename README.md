# Конфігурація NixOS для arakviel-pc

Цей репозиторій містить конфігурацію NixOS для `arakviel-pc`, керовану за допомогою Nix flakes. Вона включає конфігурації для системи, робочого середовища, інструментів розробки, служб Docker та налаштувань користувача.

## Посібник зі встановлення

Цей посібник описує кроки для встановлення NixOS за допомогою цієї конфігурації.

**Передумови:**

*   Базове розуміння NixOS та менеджера пакетів Nix.
*   Підключення до Інтернету під час встановлення.
*   USB-накопичувач (мінімум 4 ГБ) для створення завантажувального ISO.
*   Цільова машина повинна мати NVMe-накопичувач за шляхом `/dev/nvme0n1`. **УВАГА: Ця конфігурація видалить усі дані на вказаному диску.**

### Крок 1: Створіть інсталяційний ISO-образ NixOS

Спочатку вам потрібно створити власний інсталяційний ISO-образ NixOS, який включає цю конкретну конфігурацію.

1.  **Клонуйте цей репозиторій:**
    ```bash
    git clone https://github.com/your-username/nixos.git # Замініть на фактичну URL-адресу репозиторію, якщо вона відрізняється
    cd nixos
    ```

2.  **Створіть ISO-образ:**
    ```bash
    nix build .#packages.x86_64-linux.arakviel-pc-iso
    ```
    Ця команда створить ISO-образ. Отриманий файл ISO буде розташований у `result/iso/nixos-*.iso`.

### Крок 2: Запишіть ISO-образ на USB-накопичувач

Після створення ISO-образу запишіть його на USB-накопичувач, щоб зробити його завантажувальним. Замініть `/dev/sdX` на шлях до вашого USB-накопичувача (наприклад, `/dev/sdb`, `/dev/sdc`). **Будьте надзвичайно обережні, щоб вибрати правильний пристрій, оскільки це призведе до видалення всіх даних на ньому.**

```bash
sudo dd if=./result/iso/nixos-*.iso of=/dev/sdX bs=4M status=progress
```

### Крок 3: Завантажтеся з USB-накопичувача

1.  Вставте завантажувальний USB-накопичувач у цільовий ПК.
2.  Перезавантажте ПК та увійдіть до налаштувань BIOS/UEFI (зазвичай натискаючи `F2`, `Del`, `F10` або `F12` під час запуску).
3.  Налаштуйте порядок завантаження, щоб завантажуватися з USB-накопичувача.
4.  Збережіть зміни та вийдіть з BIOS/UEFI. Система повинна завантажитися в середовище інсталятора NixOS.

### Крок 4: Підключіться до Інтернету (якщо ще не підключені)

Власний ISO-образ налаштований на використання NetworkManager. Якщо ви використовуєте Wi-Fi, ви можете підключитися за допомогою команди `nmtui`:

```bash
nmtui
```
Дотримуйтесь підказок на екрані, щоб підключитися до вашої мережі Wi-Fi.

### Крок 5: Перевірте пристрій диска

Переконайтеся, що ваш цільовий NVMe-накопичувач виявлено як `/dev/nvme0n1`. Ви можете переглянути список дискових пристроїв за допомогою:

```bash
lsblk
```
Якщо ваш NVMe-накопичувач має інший шлях, вам потрібно буде змінити `flake.nix` перед продовженням встановлення.

### Крок 6: Встановіть NixOS

Ця конфігурація використовує `disko` для автоматичного розділення та форматування диска `/dev/nvme0n1`. Розмітка диска виглядає наступним чином:

*   `/dev/nvme0n1p1`: `/boot` (FAT32, 1 ГБ)
*   `/dev/nvme0n1p2`: `/` (ext4, 50 ГБ)
*   `/dev/nvme0n1p3`: `swap` (4 ГБ)
*   `/dev/nvme0n1p4`: `/home` (ext4, решта місця)

**УВАГА: Цей крок видалить усі дані на `/dev/nvme0n1`.**

1.  **Перейдіть до каталогу конфігурації:**
    ```bash
    cd /mnt/etc/nixos # Середовище інсталятора монтує конфігурацію тут
    ```
    Якщо конфігурація відсутня за шляхом `/mnt/etc/nixos`, можливо, вам доведеться клонувати її знову:
    ```bash
    git clone https://github.com/your-username/nixos.git /mnt/etc/nixos
    cd /mnt/etc/nixos
    ```

2.  **Виконайте команду встановлення NixOS:**
    ```bash
    nixos-install --flake .#arakviel-pc
    ```
    Ця команда застосує конфігурацію, розділить диск, встановить систему та налаштує завантажувач.

### Крок 7: Перезавантажтеся

Після успішного завершення встановлення перезавантажте систему:

```bash
reboot
```

Вийміть USB-накопичувач, коли з'явиться відповідний запит. Ваша нова система NixOS повинна тепер завантажитися.

### Після встановлення

*   Користувач за замовчуванням `arakviel` буде створений з паролем, вказаним у `modules/users.nix` (якщо такий є, інакше вам буде запропоновано ввести його під час встановлення або потрібно буде встановити його вручну).
*   Система включатиме робоче середовище, інструменти розробки та інші програми, визначені у файлах конфігурації.
